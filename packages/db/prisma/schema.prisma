generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model StepLog {
  id         String   @id @default(cuid())
  ts         DateTime @default(now())

  step       String
  ok         Boolean
  durationMs Int?

  env        String
  poolKey    String?
  address    String?
  managerId  String?
  managerKey String?

  output     String? // SQLite doesn't support Json type
  error      String?
}

model TxLog {
  digest     String   @id
  ts         DateTime @default(now())

  env        String
  poolKey    String?
  sender     String?

  kind       String?
  success    Boolean?
  error      String?

  meta       String? // SQLite doesn't support Json type
}

model BalanceSnapshot {
  id         String   @id @default(cuid())
  ts         DateTime @default(now())

  env        String
  poolKey    String?
  managerId  String?
  managerKey String?

  baseKey    String?
  quoteKey   String?

  availBase  String?
  availQuote String?
  lockedBase String?
  lockedQuote String?

  meta       String? // SQLite doesn't support Json type
}

model OrderEvent {
  id         String   @id @default(cuid())
  ts         DateTime @default(now())

  env        String
  poolKey    String
  managerId  String
  managerKey String

  action     String   // PLACE | CANCEL
  side       String   // BUY | SELL

  priceMicro String?
  qtyBase    String?

  clientOrderId String?
  orderId       String?
  txDigest      String?

  meta       String? // SQLite doesn't support Json type
}
